import{h as ze,g as Te,r as i,j as e,F as B,f as fe,M as K,A as Le,i as De,k as ne,B as le,S as ie,C as Pe}from"./vendor-react-CGk5Sa5S.js";import{X,S as ee,M as te,a as Ie,T as be,C as $e,I as _e,P as ye,b as Re,c as Oe,d as He,A as qe,e as W,B as We,f as Ge,g as Ke,h as Ue,L as ce,i as je,j as Ye,k as Je,l as Qe,m as de,n as he,U as we,o as V,p as ue,q as me,D as Ve,Z as Ze,r as Xe,s as et,t as tt,u as st,v as rt}from"./vendor-utils-DHVHxee-.js";import{h as q}from"./vendor-charts-BtNFOHZU.js";import{P as at,L as ot,B as nt}from"./vendor-mui-CErSjts3.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const t of r)if(t.type==="childList")for(const d of t.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&n(d)}).observe(document,{childList:!0,subtree:!0});function h(r){const t={};return r.integrity&&(t.integrity=r.integrity),r.referrerPolicy&&(t.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?t.credentials="include":r.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function n(r){if(r.ep)return;r.ep=!0;const t=h(r);fetch(r.href,t)}})();var U={},xe;function lt(){if(xe)return U;xe=1;var s=ze();return U.createRoot=s.createRoot,U.hydrateRoot=s.hydrateRoot,U}var it=lt();const ct=Te(it);function dt({show:s,onClose:a,onClearHistory:h,currentTheme:n,onThemeChange:r}){const[t,d]=i.useState(!1);return i.useEffect(()=>{d(!!s)},[s]),s?e.jsx("div",{className:"position-fixed top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center",style:{background:"rgba(0, 0, 0, 0.4)",zIndex:1050,backdropFilter:"blur(8px)",opacity:t?1:0,transition:"opacity 0.2s ease-in-out"},onClick:a,children:e.jsxs("div",{className:"bg-white rounded-4 shadow-lg overflow-hidden d-flex flex-column",style:{width:"500px",maxWidth:"90%",maxHeight:"85vh",transform:t?"scale(1) translateY(0)":"scale(0.95) translateY(20px)",transition:"transform 0.3s cubic-bezier(0.16, 1, 0.3, 1)",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)"},onClick:l=>l.stopPropagation(),children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between px-4 py-3 border-bottom bg-white sticky-top",children:[e.jsx("h5",{className:"m-0 fw-bold text-dark d-flex align-items-center gap-2",children:"Settings"}),e.jsx("button",{onClick:a,className:"btn btn-light rounded-circle p-2 d-flex align-items-center justify-content-center border-0 text-secondary",style:{width:"32px",height:"32px",transition:"background-color 0.2s"},children:e.jsx(X,{size:18})})]}),e.jsxs("div",{className:"p-4 overflow-y-auto",style:{scrollbarWidth:"thin"},children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"small fw-bold text-secondary text-uppercase tracking-wider mb-3 d-block ps-1",children:"Appearance"}),e.jsxs("div",{className:"bg-light rounded-4 p-1 d-flex mb-3 border",children:[e.jsxs("button",{className:`btn border-0 flex-grow-1 py-2 rounded-3 d-flex align-items-center justify-content-center gap-2 fw-medium transition-all ${n==="light"?"bg-white shadow-sm text-dark":"text-muted"}`,onClick:()=>r("light"),children:[e.jsx(ee,{size:16})," Light"]}),e.jsxs("button",{className:`btn border-0 flex-grow-1 py-2 rounded-3 d-flex align-items-center justify-content-center gap-2 fw-medium transition-all ${n==="dark"?"bg-white shadow-sm text-dark":"text-muted"}`,onClick:()=>r("dark"),children:[e.jsx(te,{size:16})," Dark"]}),e.jsxs("button",{className:`btn border-0 flex-grow-1 py-2 rounded-3 d-flex align-items-center justify-content-center gap-2 fw-medium transition-all ${n==="system"?"bg-white shadow-sm text-dark":"text-muted"}`,onClick:()=>r("system"),children:[e.jsx(Ie,{size:16})," System"]})]}),e.jsx("p",{className:"small text-muted mb-0 ps-1",children:n==="system"?"Theme will follow your system preferences":`Using ${n} theme`})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"small fw-bold text-secondary text-uppercase tracking-wider mb-3 d-block ps-1",children:"Data & Storage"}),e.jsx("div",{className:"d-flex flex-column gap-2",children:e.jsxs("button",{onClick:()=>{window.confirm("Are you sure you want to clear the entire chat history?")&&(h(),a())},className:"btn btn-outline-danger w-100 text-start p-3 rounded-4 border hover-bg-danger-subtle border-danger-subtle transition d-flex align-items-center justify-content-between group",children:[e.jsxs("div",{className:"d-flex align-items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-3 bg-danger bg-opacity-10 text-danger",children:e.jsx(be,{size:20})}),e.jsxs("div",{children:[e.jsx("span",{className:"d-block fw-semibold text-dark",children:"Clear Chat History"}),e.jsx("span",{className:"small text-muted",children:"Permanently remove all messages"})]})]}),e.jsx($e,{size:18,className:"text-muted opacity-50"})]})})]})]}),e.jsxs("div",{className:"p-3 bg-light border-top text-center d-flex align-items-center justify-content-center gap-2",children:[e.jsx(_e,{size:14,className:"text-muted"}),e.jsx("span",{className:"small text-muted font-monospace",children:"NovaChat AI v1.2.0 • Build 2026.02"})]})]})}):null}const ht=({query:s,setQuery:a,onSend:h,isLoading:n,onNewChat:r})=>{const t=i.useRef(null);i.useEffect(()=>{t.current&&(t.current.style.height="auto",t.current.style.height=`${Math.min(t.current.scrollHeight,120)}px`)},[s]);const d=c=>{c.key==="Enter"&&!c.shiftKey&&(c.preventDefault(),h())},l=c=>{c.preventDefault(),h()};return e.jsx("div",{className:"p-4 bg-white border-top border-gray-100 chat-input-container",children:e.jsxs("div",{className:"d-flex align-items-center gap-2 px-3 py-2",style:{borderRadius:"24px",background:"linear-gradient(to right, #ffffff, #fff1f2)",border:"1px solid rgba(244, 63, 94, 0.1)",boxShadow:"0 8px 30px rgba(0, 0, 0, 0.05)"},children:[e.jsx("button",{onClick:r,className:"btn p-0 text-rose-500 bg-white border border-rose-100 hover:bg-rose-50 hover:text-rose-600 rounded-circle transition-all shadow-sm d-flex align-items-center justify-content-center",style:{width:"40px",height:"40px"},title:"New Chat",children:e.jsx(ye,{size:20})}),e.jsx(B,{onSubmit:l,className:"flex-grow-1",children:e.jsx("textarea",{ref:t,className:"w-100 bg-transparent border-0 text-gray-800 focus:outline-none custom-scrollbar placeholder-gray-400",style:{outline:"none",boxShadow:"none",resize:"none",height:"24px",maxHeight:"120px",overflowY:"auto",lineHeight:"1.5"},placeholder:"Ask anything...",value:s,onChange:c=>a(c.target.value),onKeyDown:d,rows:1})}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{className:"btn p-0 text-gray-500 bg-white border border-gray-100 hover:bg-gray-50 hover:text-gray-700 rounded-circle transition-all shadow-sm d-flex align-items-center justify-content-center",style:{width:"40px",height:"40px"},children:e.jsx(Re,{size:20})}),e.jsx("button",{onClick:h,className:"btn p-0 rounded-circle text-white d-flex align-items-center justify-content-center transition-all hover:scale-105 active:scale-95",disabled:!s.trim()&&!n,style:{background:n?"#F43F5E":"linear-gradient(135deg, #F43F5E 0%, #E11D48 100%)",boxShadow:"0 4px 12px rgba(244, 63, 94, 0.3)",width:"40px",height:"40px",opacity:!s.trim()&&!n?.7:1,cursor:!s.trim()&&!n?"default":"pointer",filter:"brightness(1)"},onMouseEnter:c=>{!s.trim()&&!n||(c.currentTarget.style.filter="brightness(1.1)",c.currentTarget.style.boxShadow="0 6px 20px rgba(244, 63, 94, 0.5)")},onMouseLeave:c=>{c.currentTarget.style.filter="brightness(1)",c.currentTarget.style.boxShadow="0 4px 12px rgba(244, 63, 94, 0.3)"},children:n?e.jsx(Oe,{size:16,fill:"white"}):e.jsx(He,{size:18})})]})]})})},ve=["#F43F5E","#E11D48","#BE123C","#9F1239","#881337"],Ne=["#22D3EE","#3B82F6","#67E8F9","#06B6D4","#0EA5E9"],ut=s=>{if(!s||s.length===0)return"total_sales";const a=Object.keys(s[0]);return a.find(n=>["sales","total_sales","profit","amount","quantity","value","impact","sales_change"].includes(n.toLowerCase()))||a.find(n=>typeof s[0][n]=="number")||"total_sales"},mt=s=>{if(!s||s.length===0)return"month";const a=Object.keys(s[0]),n=["month","year","quarter","date","order_date","category","sub-category","sub_category","sub_categoory","region","product_name","segment","state","city"].find(d=>a.includes(d));if(n)return n;const r=["sales","total_sales","profit","amount","quantity","value","count","impact","cost","discount","sales_change"];return a.find(d=>!r.includes(d.toLowerCase())&&typeof s[0][d]=="string")||"month"},G=(s="light")=>{const a=s==="dark";return{chart:{background:"transparent",toolbar:{show:!1},animations:{enabled:!0},fontFamily:"Inter, sans-serif"},theme:{mode:a?"dark":"light"},dataLabels:{enabled:!1},grid:{show:!1,borderColor:a?"#374151":"#E5E7EB"},xaxis:{labels:{style:{colors:a?"#9CA3AF":"#374151"}},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{labels:{style:{colors:a?"#9CA3AF":"#374151"}}},legend:{labels:{colors:a?"#E5E7EB":"#374151"}},tooltip:{theme:a?"dark":"light"}}},xt=(s,a,h,n)=>{const r=n==="dark",t=r?"#22D3EE":"#F43F5E",d=r?"#3B82F6":"#BE123C";return{series:[{type:"boxPlot",data:s.map(c=>({x:c[h],y:c.quartiles||[c[a]*.8,c[a]*.9,c[a],c[a]*1.1,c[a]*1.2]}))}],options:{...G(n),chart:{type:"boxPlot",height:350},title:{text:`Distribution of ${a}`,align:"left",style:{color:t}},plotOptions:{boxPlot:{colors:{upper:t,lower:d}}}}}},gt=(s,a,h,n)=>{const r=n==="dark",t=r?"#22D3EE":"#F43F5E";return{series:[{name:a,data:s.map(l=>({x:l[h],y:l[a]}))}],options:{...G(n),chart:{type:"heatmap",height:350},plotOptions:{heatmap:{shadeIntensity:.5,radius:0,useFillColorAsStroke:!0,colorScale:{ranges:[{from:0,to:1e9,name:"scale",color:t}]}}},dataLabels:{enabled:!1},stroke:{width:1,colors:[r?"#0B1220":"#fff"]}}}},pt=(s,a,h,n)=>{const r=n==="dark",t=r?Ne:ve,d=r?"#22D3EE":"#F43F5E";return{series:[{data:s.map(l=>({x:l[h],y:l[a]}))}],options:{...G(n),chart:{type:"treemap",height:350},colors:t,title:{text:`Composition by ${h}`,style:{color:d}}}}},ft=(s,a,h,n)=>{const r=n==="dark",t=r?"#22D3EE":"#F43F5E";return{series:[{name:a,data:s.map((l,c)=>[c+10,l[a],l[a]/100])}],options:{...G(n),chart:{type:"bubble",height:350},xaxis:{type:"numeric",labels:{style:{colors:r?"#9CA3AF":"#374151"}}},fill:{opacity:.8},colors:[t]}}},bt=(s,a,h,n)=>{const r=n==="dark",t=r?"#22D3EE":"#F43F5E",d=r?"#3B82F6":"#BE123C";return{series:[{name:a,data:s.map(l=>l[a])}],options:{...G(n),chart:{type:"area",height:350},stroke:{curve:"smooth",colors:[t]},xaxis:{categories:s.map(l=>l[h]),labels:{style:{colors:r?"#9CA3AF":"#374151"}}},fill:{type:"gradient",gradient:{shadeIntensity:1,opacityFrom:.7,opacityTo:.3,stops:[0,90,100],colorStops:[{offset:0,color:t,opacity:.8},{offset:100,color:d,opacity:.2}]}},dataLabels:{enabled:!1}}}};function yt({type:s,title:a,data:h,loading:n,theme:r="light"}){if(n)return e.jsx("div",{className:"animate-pulse h-64 bg-gray-100 rounded-xl"});if(!h)return null;if(h.error)return e.jsxs("div",{className:"bg-red-50 p-4 rounded-xl border border-red-100 my-4",children:[e.jsxs("h3",{className:"text-red-500 font-semibold mb-2 flex items-center gap-2",children:[e.jsx(qe,{size:16}),"Analysis Error"]}),e.jsx("code",{className:"text-xs text-red-400 block overflow-auto whitespace-pre-wrap",children:h.error})]});if(!Array.isArray(h)||h.length===0)return null;const t=r==="dark",d=ut(h),l=mt(h),c=h.map(u=>{const x={...u};return x[d]==null&&(x[d]=0),x[l]==null&&(x[l]="Unknown"),x}),F=s==="region"||s==="rca"||s==="decline"||s==="bar",p=F?Math.max(400,c.length*50):400,o=window.innerWidth<768,f={dataset:c,margin:{top:20,bottom:40,left:o?120:100,right:20},height:p,slotProps:{legend:{hidden:!0}}},y=t?"#22D3EE":"#F43F5E",j=t?"#67E8F9":"#FB7185",N=t?"#9CA3AF":"#374151",k=t?"#374151":"#E5E7EB",b=t?"#E5E7EB":"#374151",M=t?Ne:ve;let S=null;if(["box_plot","box","violin"].includes(s)){const u=xt(c,d,l,r);S=e.jsx(q,{options:u.options,series:u.series,type:"boxPlot",height:350})}else if(["heatmap"].includes(s)){console.log("Rendering HEATMAP with theme:",r);const u=gt(c,d,l,r);S=e.jsx(q,{options:u.options,series:u.series,type:"heatmap",height:350})}else if(["treemap"].includes(s)){const u=pt(c,d,l,r);S=e.jsx(q,{options:u.options,series:u.series,type:"treemap",height:350})}else if(["bubble"].includes(s)){const u=ft(c,d,l,r);S=e.jsx(q,{options:u.options,series:u.series,type:"bubble",height:350})}else if(["area"].includes(s)){const u=bt(c,d,l,r);S=e.jsx(q,{options:u.options,series:u.series,type:"area",height:350})}else if(s==="aggregate"&&c.length===1)S=e.jsxs("div",{className:"flex flex-col items-center justify-center h-[300px] text-center",children:[e.jsx("span",{className:`text-lg mb-2 capitalize ${t?"text-gray-400":"text-gray-500"}`,children:d.replace(/_/g," ")}),e.jsx("span",{className:`text-6xl font-bold tracking-tight ${t?"text-gray-100":"text-gray-900"}`,children:c[0][d]?.toLocaleString("en-US",{style:"decimal",maximumFractionDigits:2})}),e.jsx("span",{className:`text-sm mt-3 font-medium px-3 py-1 rounded-full ${t?"text-cyan-400 bg-cyan-900/30":"text-rose-500 bg-rose-50"}`,children:"Aggregate Value"})]});else if(["trend","line","scatter","lag"].includes(s)){const u=s==="scatter"||s==="lag";S=e.jsx(ot,{...f,xAxis:[{scaleType:"point",dataKey:l,tickLabelStyle:{fill:N,fontSize:12},labelStyle:{fill:N}}],yAxis:[{labelStyle:{fill:N},tickLabelStyle:{fill:N,fontSize:12}}],series:[{dataKey:d,area:!u,color:u?j:y,showMark:u,showLine:!u}],grid:{vertical:u,horizontal:!0},sx:{".MuiChartsAxis-line":{stroke:k},".MuiChartsAxis-tick":{stroke:k}}})}else if(["distribution","pie","donut"].includes(s)){const u=s==="donut";S=e.jsx(at,{series:[{data:c.map((x,D)=>({id:D,value:Math.abs(x[d]),label:x[l],color:M[D%M.length]})),innerRadius:u?70:30,outerRadius:100,paddingAngle:5,cornerRadius:5,highlightScope:{faded:"global",highlighted:"item"},faded:{innerRadius:30,additionalRadius:-30,color:"gray"}}],height:300,slotProps:{legend:{direction:"column",position:{vertical:"middle",horizontal:"end"}}},sx:{".MuiChartsLegend-series text":{fill:`${b} !important`},".MuiChartsLegend-root text":{fill:`${b} !important`},".MuiChartsLegend-label":{fill:`${b} !important`},".MuiChartsLabel-root":{fill:`${b} !important`},".MuiChartsLegend-root":{fill:`${b} !important`,color:`${b} !important`}}})}else S=e.jsx(nt,{...f,layout:F?"horizontal":"vertical",xAxis:F?[{tickLabelStyle:{fill:N,fontSize:12}}]:[{scaleType:"band",dataKey:l,tickLabelStyle:{fill:N,fontSize:12}}],yAxis:F?[{scaleType:"band",dataKey:l,tickLabelStyle:{fill:N,fontSize:12},valueFormatter:u=>u}]:[{tickLabelStyle:{fill:N,fontSize:12}}],series:[{dataKey:d,color:y}],sx:{".MuiChartsAxis-line":{stroke:k},".MuiChartsAxis-tick":{stroke:k}}});return e.jsxs("div",{style:{width:"100%"},children:[e.jsxs("h3",{className:`font-semibold mb-4 text-sm uppercase tracking-wider flex items-center gap-2 font-outfit ${t?"text-gray-300":"text-gray-800"}`,children:[e.jsx("span",{className:`w-2 h-2 rounded-full shadow-sm ${t?"bg-cyan-400":"bg-rose-500"}`}),e.jsx("span",{className:"tracking-widest",children:a||"Data Analysis"})]}),e.jsx("div",{style:{width:"100%",height:p},children:S})]})}const jt=({history:s,isLoading:a,onQuickAction:h,theme:n})=>{const r=i.useRef(null),t=()=>{r.current?.scrollIntoView({behavior:"smooth"})};i.useEffect(t,[s]);const d=l=>{if(!l)return"";let c=l;const F=c.split(`
`);let p=!1,o=[],f=[];for(let y=0;y<F.length;y++){const j=F[y].trim();if(j.startsWith("|")&&j.endsWith("|")){if(j.match(/^\|[\s\-|]+\|$/))continue;p||(p=!0,o=[]);const N=j.split("|").filter(k=>k.trim()!=="");o.push(N.map(k=>k.trim()))}else{if(p&&o.length>0){let N='<table class="md-table"><thead><tr>';N+=o[0].map(k=>`<th>${k}</th>`).join(""),N+="</tr></thead><tbody>";for(let k=1;k<o.length;k++)N+="<tr>"+o[k].map(b=>`<td>${b}</td>`).join("")+"</tr>";N+="</tbody></table>",f.push(N),o=[],p=!1}f.push(j)}}if(p&&o.length>0){let y='<table class="md-table"><thead><tr>';y+=o[0].map(j=>`<th>${j}</th>`).join(""),y+="</tr></thead><tbody>";for(let j=1;j<o.length;j++)y+="<tr>"+o[j].map(N=>`<td>${N}</td>`).join("")+"</tr>";y+="</tbody></table>",f.push(y)}return c=f.join("<br/>"),c=c.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/`(.*?)`/g,'<code class="px-1 rounded">$1</code>'),c};return s.length===0?e.jsxs("div",{className:"h-100 d-flex flex-column align-items-center justify-content-center text-center",children:[e.jsxs("div",{className:"mb-4 position-relative",children:[e.jsx("div",{className:"position-absolute top-50 start-50 translate-middle",style:{width:"200px",height:"200px",background:"radial-gradient(circle, rgba(244, 63, 94, 0.2) 0%, transparent 70%)",filter:"blur(40px)"}}),e.jsx("div",{className:"bg-white p-4 rounded-circle shadow-sm border border-rose-100 position-relative z-10",children:e.jsx(W,{size:48,className:"text-rose-500"})})]}),e.jsx("h1",{className:"fw-bold mb-2",style:{background:"linear-gradient(135deg, #111827 30%, #F43F5E 100%)",WebkitBackgroundClip:"text",backgroundClip:"text",WebkitTextFillColor:"transparent",color:"transparent",filter:"drop-shadow(0 2px 10px rgba(244, 63, 94, 0.2))",fontSize:"2.5rem"},children:"How can I help you?"}),e.jsx("p",{className:"text-gray-500 max-w-md fs-5",children:"I can analyze data, generate reports, or visualize trends for you."}),e.jsxs("div",{className:"d-flex gap-3 mt-4 flex-wrap justify-content-center",children:[e.jsxs("button",{onClick:()=>h("Show total sales"),className:"px-4 py-3 text-sm text-gray-700 hover:text-rose-600 d-flex align-items-center gap-2 transition-all shadow-sm hover:shadow-lg hover:-translate-y-1 border border-gray-100 rounded-xl",style:{background:"linear-gradient(to bottom right, #ffffff, #f9fafb)"},children:[e.jsx(We,{size:16})," Total Sales"]}),e.jsxs("button",{onClick:()=>h("Analyze profit trends"),className:"px-4 py-3 text-sm text-gray-700 hover:text-rose-600 d-flex align-items-center gap-2 transition-all shadow-sm hover:shadow-lg hover:-translate-y-1 border border-gray-100 rounded-xl",style:{background:"linear-gradient(to bottom right, #ffffff, #f9fafb)"},children:[e.jsx(Ge,{size:16})," Profit Trends"]}),e.jsxs("button",{onClick:()=>h("Top 5 products"),className:"px-4 py-3 text-sm text-gray-700 hover:text-rose-600 d-flex align-items-center gap-2 transition-all shadow-sm hover:shadow-lg hover:-translate-y-1 border border-gray-100 rounded-xl",style:{background:"linear-gradient(to bottom right, #ffffff, #f9fafb)"},children:[e.jsx(Ke,{size:16})," Top Products"]})]})]}):e.jsxs("div",{className:"flex-grow-1 overflow-auto p-4 custom-scrollbar d-flex flex-column",id:"chat-container",children:[s.map((l,c)=>e.jsxs("div",{className:`d-flex mb-5 gap-3 ${l.role==="user"?"justify-content-end":"justify-content-start"}`,children:[l.role==="assistant"&&e.jsx("div",{className:"flex-shrink-0 mt-1",children:e.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center shadow-sm",style:{width:"36px",height:"36px",background:"var(--theme-primary)"},children:e.jsx(W,{size:18,className:"text-white"})})}),e.jsx("div",{className:`d-flex flex-column ${l.role==="user"?"align-items-end":"align-items-start"}`,style:{maxWidth:"80%"},children:l.role==="user"?e.jsx("div",{className:"p-3 px-4 shadow-sm",style:{color:"var(--bubble-user-text)",borderRadius:"24px 24px 0 24px",background:"linear-gradient(135deg, #111827 0%, #1f2937 100%)"},children:l.content}):e.jsxs("div",{className:"p-4 shadow-sm",style:{background:"var(--bubble-bot-bg)",color:"var(--bubble-bot-text)",borderRadius:"0 24px 24px 24px",border:"1px solid #E5E7EB"},children:[e.jsx("div",{dangerouslySetInnerHTML:{__html:d(l.content)+(a&&c===s.length-1&&l.role==="assistant"?'<span class="typing-cursor"></span>':"")}}),l.chart&&l.chart.data&&e.jsx("div",{className:"mt-4 rounded-xl overflow-hidden border border-gray-200 bg-white p-1 shadow-sm",children:e.jsx(yt,{data:l.chart.data,type:l.chart.type,theme:n})})]})})]},c)),e.jsx("div",{ref:r})]})},wt=fe.memo(jt),se="http://192.168.0.107:8000",re="nova_auth_token",Ce=()=>localStorage.getItem(re),ke=s=>{localStorage.setItem(re,s)},Fe=()=>{localStorage.removeItem(re)},ae=()=>{const s=Ce();return s?{Authorization:`Bearer ${s}`}:{}},I=async(s,a={})=>{const h=`${se}${s}`,n={"Content-Type":"application/json",...ae(),...a.headers},r=await fetch(h,{...a,headers:n});if(!r.ok){const t=await r.json().catch(()=>({detail:"Request failed"}));throw new Error(t.detail||`HTTP ${r.status}`)}return r.json()},vt=async s=>{const a=await I("/api/auth/register",{method:"POST",body:JSON.stringify(s)});return ke(a.access_token),a},Nt=async s=>{const a=await I("/api/auth/login",{method:"POST",body:JSON.stringify(s)});return ke(a.access_token),a},Ct=()=>{Fe()},kt=async()=>I("/api/auth/me"),Se=i.createContext(null),oe=()=>{const s=i.useContext(Se);if(!s)throw new Error("useAuth must be used within an AuthProvider");return s},Ft=({children:s})=>{const[a,h]=i.useState(null),[n,r]=i.useState(!0),[t,d]=i.useState(!1);i.useEffect(()=>{(async()=>{if(Ce())try{const y=await kt();h(y),d(!0)}catch(y){console.error("Token validation failed:",y),Fe()}r(!1)})()},[]);const l=i.useCallback(async o=>{r(!0);try{const f=await Nt(o);return h(f.user),d(!0),f}finally{r(!1)}},[]),c=i.useCallback(async o=>{r(!0);try{const f=await vt(o);return h(f.user),d(!0),f}finally{r(!1)}},[]),F=i.useCallback(()=>{Ct(),h(null),d(!1)},[]),p={user:a,isLoading:n,isAuthenticated:t,login:l,register:c,logout:F};return e.jsx(Se.Provider,{value:p,children:s})},St=async(s=50)=>I(`/api/conversations/sidebar?limit=${s}`),Et=async(s={})=>I("/api/conversations",{method:"POST",body:JSON.stringify(s)}),At=async(s,a)=>I(`/api/conversations/${s}/title`,{method:"PUT",body:JSON.stringify({title:a})}),Bt=async s=>{const a=await fetch(`${se}/api/conversations/${s}`,{method:"DELETE",headers:ae()});if(!a.ok&&a.status!==204)throw new Error("Failed to delete conversation");return!0},ge=async(s,a=1,h=30)=>I(`/api/conversations/${s}/messages?page=${a}&page_size=${h}`),Z=async s=>I("/api/conversations/messages",{method:"POST",body:JSON.stringify(s)}),Mt=async s=>I("/api/conversations/artifacts",{method:"POST",body:JSON.stringify(s)}),Ee=i.createContext(null),Ae=()=>{const s=i.useContext(Ee);if(!s)throw new Error("useConversations must be used within a ConversationsProvider");return s},zt=({children:s})=>{const{isAuthenticated:a}=oe(),[h,n]=i.useState([]),[r,t]=i.useState(null),[d,l]=i.useState([]),[c,F]=i.useState(!1),[p,o]=i.useState(!1),[f,y]=i.useState(1),[j,N]=i.useState(!1);i.useEffect(()=>{a?k():(n([]),t(null),l([]))},[a]);const k=i.useCallback(async()=>{F(!0);try{const m=await St();n(m.conversations)}catch(m){console.error("Failed to load sidebar:",m)}finally{F(!1)}},[]),b=i.useCallback(async m=>{if(m!==r){t(m),l([]),y(1),o(!0);try{const C=await ge(m,1,30);l(C.messages),N(C.has_more)}catch(C){console.error("Failed to load messages:",C)}finally{o(!1)}}},[r]),M=i.useCallback(async()=>{if(!r||p||!j)return;const m=f+1;o(!0);try{const C=await ge(r,m,30);l(g=>[...C.messages,...g]),y(m),N(C.has_more)}catch(C){console.error("Failed to load more messages:",C)}finally{o(!1)}},[r,f,p,j]),S=i.useCallback(async(m=null)=>{try{const g=await Et(m?{first_message:m}:{});return n(v=>[{id:g.id,title:g.title,last_message:null,updated_at:g.updated_at},...v]),t(g.id),l([]),g}catch(C){throw console.error("Failed to create conversation:",C),C}},[]),u=i.useCallback(()=>{t(null),l([])},[]),x=i.useCallback(async m=>{try{await Bt(m),n(C=>C.filter(g=>g.id!==m)),r===m&&(t(null),l([]))}catch(C){throw console.error("Failed to delete conversation:",C),C}},[r]),D=i.useCallback(async(m,C)=>{try{await At(m,C),n(g=>g.map(v=>v.id===m?{...v,title:C}:v))}catch(g){throw console.error("Failed to update title:",g),g}},[]),_=i.useCallback(m=>{l(C=>[...C,m])},[]),R=i.useCallback(m=>{l(C=>{const g=[...C];return g.length>0&&(g[g.length-1]=typeof m=="function"?m(g[g.length-1]):m),g})},[]),O=i.useCallback((m,C)=>{n(g=>{const v=g.map(E=>E.id===m?{...E,last_message:C,updated_at:new Date().toISOString()}:E);return v.sort((E,A)=>new Date(A.updated_at)-new Date(E.updated_at)),v})},[]),w={conversations:h,activeConversationId:r,messages:d,isLoadingSidebar:c,isLoadingMessages:p,hasMoreMessages:j,loadSidebar:k,selectConversation:b,loadMoreMessages:M,createNewConversation:S,startNewChat:u,deleteConversation:x,updateTitle:D,addMessage:_,updateLastMessage:R,updateSidebarItem:O};return e.jsx(Ee.Provider,{value:w,children:s})},Tt=({isOpen:s,onClose:a,theme:h="light"})=>{const{conversations:n,activeConversationId:r,isLoadingSidebar:t,selectConversation:d,startNewChat:l,deleteConversation:c,updateTitle:F}=Ae(),p=h==="dark",o={gradient:p?"linear-gradient(135deg, #22D3EE, #3B82F6)":"linear-gradient(135deg, #FF6B6B, #FF8E53)",activeItemBg:p?"rgba(34, 211, 238, 0.1)":"#FFE5E5",activeIconColor:p?"#22D3EE":"#FF6B6B",sidebarBg:p?"#111827":"#FAFAFA",borderColor:p?"#374151":"#E5E7EB",textPrimary:p?"#F9FAFB":"#1F2937",textSecondary:p?"#9CA3AF":"#6B7280",inputBg:p?"#1F2937":"#F3F4F6"},[f,y]=i.useState(""),[j,N]=i.useState(null),[k,b]=i.useState(""),[M,S]=i.useState(null),u=n.filter(w=>w.title.toLowerCase().includes(f.toLowerCase())||w.last_message?.toLowerCase().includes(f.toLowerCase())),x=w=>{const m=new Date(w),g=new Date-m,v=Math.floor(g/6e4),E=Math.floor(g/36e5),A=Math.floor(g/864e5);return v<1?"Just now":v<60?`${v}m ago`:E<24?`${E}h ago`:A<7?`${A}d ago`:m.toLocaleDateString()},D=(w,m)=>{w.stopPropagation(),N(m.id),b(m.title)},_=async w=>{w.stopPropagation(),k.trim()&&await F(j,k.trim()),N(null)},R=w=>{w.stopPropagation(),N(null)},O=async(w,m)=>{w.stopPropagation(),S(m);try{await c(m)}finally{S(null)}};return e.jsxs("div",{className:`sidebar ${s?"sidebar-open":""}`,style:{width:"280px",height:"100%",display:"flex",flexDirection:"column",backgroundColor:o.sidebarBg,borderRight:`1px solid ${o.borderColor}`},children:[e.jsxs("div",{className:"p-3 border-bottom d-flex gap-2",style:{borderColor:o.borderColor},children:[e.jsxs("button",{onClick:l,className:"btn flex-grow-1 d-flex align-items-center justify-content-center gap-2 py-2",style:{background:o.gradient,border:"none",color:"white",borderRadius:"10px",fontWeight:"500"},children:[e.jsx(ye,{size:18}),"New Chat"]}),e.jsx("button",{className:"btn d-md-none d-flex align-items-center justify-content-center p-2",onClick:a,style:{color:o.textSecondary,backgroundColor:o.inputBg,borderRadius:"10px"},children:e.jsx(X,{size:20})})]}),e.jsx("div",{className:"px-3 py-2",children:e.jsxs("div",{className:"position-relative",children:[e.jsx(Ue,{size:16,className:"position-absolute",style:{left:"12px",top:"50%",transform:"translateY(-50%)",color:o.textSecondary}}),e.jsx("input",{type:"text",placeholder:"Search conversations...",value:f,onChange:w=>y(w.target.value),className:"form-control form-control-sm",style:{paddingLeft:"36px",backgroundColor:o.inputBg,border:"none",borderRadius:"8px",color:o.textPrimary}})]})}),e.jsx("div",{className:"flex-grow-1 overflow-auto px-2 py-1",style:{scrollbarWidth:"thin"},children:t?e.jsx("div",{className:"d-flex justify-content-center align-items-center py-4",children:e.jsx(ce,{size:24,className:"animate-spin",style:{color:o.textSecondary}})}):u.length===0?e.jsx("div",{className:"text-center py-4 small",style:{color:o.textSecondary},children:f?"No matching conversations":"No conversations yet"}):u.map(w=>e.jsx("div",{onClick:()=>d(w.id),className:"conversation-item p-2 rounded-2 mb-1 cursor-pointer",style:{backgroundColor:r===w.id?o.activeItemBg:"transparent",cursor:"pointer",transition:"all 0.15s ease"},children:e.jsxs("div",{className:"d-flex align-items-start gap-2",children:[e.jsx(je,{size:16,className:"mt-1 flex-shrink-0",style:{color:r===w.id?o.activeIconColor:o.textSecondary}}),e.jsx("div",{className:"flex-grow-1 min-width-0",children:j===w.id?e.jsxs("div",{className:"d-flex gap-1",children:[e.jsx("input",{type:"text",value:k,onChange:m=>b(m.target.value),onClick:m=>m.stopPropagation(),className:"form-control form-control-sm py-0",style:{fontSize:"13px",backgroundColor:o.inputBg,color:o.textPrimary,border:`1px solid ${o.borderColor}`},autoFocus:!0}),e.jsx("button",{className:"btn btn-link p-0 text-success",onClick:_,children:e.jsx(Ye,{size:14})}),e.jsx("button",{className:"btn btn-link p-0",onClick:R,style:{color:o.textSecondary},children:e.jsx(X,{size:14})})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fw-medium text-truncate",style:{fontSize:"13px",color:o.textPrimary},children:w.title}),w.last_message&&e.jsx("div",{className:"text-truncate",style:{fontSize:"11px",color:o.textSecondary},children:w.last_message}),e.jsxs("div",{className:"d-flex align-items-center gap-1 mt-1",style:{fontSize:"10px",color:o.textSecondary},children:[e.jsx(Je,{size:10}),x(w.updated_at)]})]})}),j!==w.id&&e.jsxs("div",{className:"conversation-actions d-flex gap-1",children:[e.jsx("button",{className:"btn btn-link p-1",onClick:m=>D(m,w),title:"Rename",style:{color:o.textSecondary},children:e.jsx(Qe,{size:12})}),e.jsx("button",{className:"btn btn-link p-1 text-danger",onClick:m=>O(m,w.id),disabled:M===w.id,title:"Delete",children:M===w.id?e.jsx(ce,{size:12,className:"animate-spin"}):e.jsx(be,{size:12})})]})]})},w.id))}),e.jsx("div",{className:"p-2 border-top text-center",style:{borderColor:o.borderColor},children:e.jsxs("small",{style:{fontSize:"10px",color:o.textSecondary},children:[n.length," conversation",n.length!==1?"s":""]})})]})},pe=({show:s,onClose:a,theme:h="light"})=>{const{login:n,register:r,isLoading:t}=oe(),[d,l]=i.useState("login"),[c,F]=i.useState(""),p=h==="dark",[o,f]=i.useState(""),[y,j]=i.useState(""),[N,k]=i.useState(""),b={gradient:p?"linear-gradient(135deg, #22D3EE, #3B82F6)":"linear-gradient(135deg, #FF6B6B, #FF8E53)",inputBg:p?"#1F2937":"#F9FAFB",inputBorder:p?"#374151":"#DEE2E6",inputText:p?"#F3F4F6":"#1F2937",textMuted:p?"#9CA3AF":"#6C757D",modalBg:p?"#111827":"#FFFFFF",modalText:p?"#F9FAFB":"#212529"},M=async x=>{x.preventDefault(),F("");try{d==="login"?await n({email:o,password:y}):await r({email:o,username:N,password:y}),f(""),j(""),k(""),a()}catch(D){F(D.message||"Authentication failed")}},S=()=>{f(""),j(""),k(""),F("")},u={backgroundColor:b.inputBg,borderColor:b.inputBorder,color:b.inputText};return e.jsxs(K,{show:s,onHide:a,centered:!0,className:"auth-modal",contentClassName:p?"bg-dark text-light border-secondary":"bg-white border-0",backdrop:"static",children:[e.jsx(K.Header,{className:"border-0 pb-0",style:{backgroundColor:b.modalBg,color:b.modalText},children:e.jsxs(K.Title,{className:"w-100 text-center",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-center gap-2 mb-2",children:e.jsx("div",{className:"p-2 rounded-circle",style:{background:b.gradient},children:e.jsx(W,{size:24,className:"text-white"})})}),e.jsx("h4",{className:"fw-bold mb-1",children:"Welcome to NovaChat"}),e.jsx("p",{className:"small mb-0",style:{color:b.textMuted},children:"Your AI-powered analytics assistant"})]})}),e.jsxs(K.Body,{className:"px-4 pb-4",style:{backgroundColor:b.modalBg},children:[c&&e.jsx(Le,{variant:"danger",className:"py-2 small",dismissible:!0,onClose:()=>F(""),children:c}),e.jsxs(De,{activeKey:d,onSelect:x=>{l(x),S()},className:"mb-3 justify-content-center border-bottom-0",fill:!0,children:[e.jsx(ne,{eventKey:"login",title:"Sign In",children:e.jsxs(B,{onSubmit:M,children:[e.jsxs(B.Group,{className:"mb-3",children:[e.jsx(B.Label,{className:"small fw-medium",style:{color:b.modalText},children:"Email"}),e.jsxs("div",{className:"input-group",children:[e.jsx("span",{className:"input-group-text border-end-0",style:{...u},children:e.jsx(de,{size:16,style:{color:b.textMuted}})}),e.jsx(B.Control,{type:"email",placeholder:"you@example.com",value:o,onChange:x=>f(x.target.value),required:!0,className:"border-start-0 shadow-none",style:u})]})]}),e.jsxs(B.Group,{className:"mb-4",children:[e.jsx(B.Label,{className:"small fw-medium",style:{color:b.modalText},children:"Password"}),e.jsxs("div",{className:"input-group",children:[e.jsx("span",{className:"input-group-text border-end-0",style:{...u},children:e.jsx(he,{size:16,style:{color:b.textMuted}})}),e.jsx(B.Control,{type:"password",placeholder:"••••••••",value:y,onChange:x=>j(x.target.value),required:!0,minLength:6,className:"border-start-0 shadow-none",style:u})]})]}),e.jsx(le,{type:"submit",className:"w-100 py-2 fw-medium transition-all hover-scale",style:{background:b.gradient,border:"none"},disabled:t,children:t?e.jsxs(e.Fragment,{children:[e.jsx(ie,{size:"sm",className:"me-2"})," Signing in..."]}):"Sign In"})]})}),e.jsx(ne,{eventKey:"register",title:"Create Account",children:e.jsxs(B,{onSubmit:M,children:[e.jsxs(B.Group,{className:"mb-3",children:[e.jsx(B.Label,{className:"small fw-medium",style:{color:b.modalText},children:"Username"}),e.jsxs("div",{className:"input-group",children:[e.jsx("span",{className:"input-group-text border-end-0",style:{...u},children:e.jsx(we,{size:16,style:{color:b.textMuted}})}),e.jsx(B.Control,{type:"text",placeholder:"johndoe",value:N,onChange:x=>k(x.target.value),required:!0,minLength:3,className:"border-start-0 shadow-none",style:u})]})]}),e.jsxs(B.Group,{className:"mb-3",children:[e.jsx(B.Label,{className:"small fw-medium",style:{color:b.modalText},children:"Email"}),e.jsxs("div",{className:"input-group",children:[e.jsx("span",{className:"input-group-text border-end-0",style:{...u},children:e.jsx(de,{size:16,style:{color:b.textMuted}})}),e.jsx(B.Control,{type:"email",placeholder:"you@example.com",value:o,onChange:x=>f(x.target.value),required:!0,className:"border-start-0 shadow-none",style:u})]})]}),e.jsxs(B.Group,{className:"mb-4",children:[e.jsx(B.Label,{className:"small fw-medium",style:{color:b.modalText},children:"Password"}),e.jsxs("div",{className:"input-group",children:[e.jsx("span",{className:"input-group-text border-end-0",style:{...u},children:e.jsx(he,{size:16,style:{color:b.textMuted}})}),e.jsx(B.Control,{type:"password",placeholder:"Min 6 characters",value:y,onChange:x=>j(x.target.value),required:!0,minLength:6,className:"border-start-0 shadow-none",style:u})]})]}),e.jsx(le,{type:"submit",className:"w-100 py-2 fw-medium transition-all hover-scale",style:{background:b.gradient,border:"none"},disabled:t,children:t?e.jsxs(e.Fragment,{children:[e.jsx(ie,{size:"sm",className:"me-2"})," Creating account..."]}):"Create Account"})]})})]})]})]})};function Lt({onLogin:s,onSignup:a,currentTheme:h,onToggleTheme:n}){const r=h==="dark",t={bg:r?"#0B1220":"#F9FAFB",text:r?"#E5E7EB":"#111827",textMuted:r?"#9CA3AF":"#6B7280",cardBg:r?"#111827":"#FFFFFF",borderColor:r?"#374151":"#E5E7EB",navBg:r?"#111827":"#FFFFFF",heroGradient:r?"linear-gradient(180deg, #0B1220 0%, #111827 100%)":"linear-gradient(180deg, #FFF5F5 0%, #FFFFFF 100%)",featureIconBg:r?"rgba(255, 107, 107, 0.1)":"#FFF5F5"},d=[{icon:ue,title:"AI-Powered Insights",description:"Advanced RAG technology analyzes your business data and documents to provide intelligent, context-aware answers."},{icon:je,title:"Natural Conversation",description:"Ask questions in plain English. No complex queries or technical knowledge required."},{icon:me,title:"Real-Time Analytics",description:"Get instant access to KPIs, trends, and performance metrics across your entire business."},{icon:Ve,title:"Multi-Source Integration",description:"Connect databases, documents, and data warehouses in one unified analytics platform."},{icon:Ze,title:"Guided Exploration",description:"Smart follow-up questions help you dive deeper and uncover hidden insights automatically."},{icon:Xe,title:"Enterprise Security",description:"Bank-level encryption and role-based access control keep your data safe and compliant."}],l=[{question:'"Why did revenue drop last quarter?"',insight:"Get root cause analysis with regional breakdowns, category impacts, and actionable recommendations."},{question:'"Show me top performing products"',insight:"Instantly view rankings with margins, inventory levels, and demand forecasts."},{question:'"Compare this year vs last year"',insight:"Automated YoY analysis with trend visualization and variance explanations."}],p=r?"linear-gradient(135deg, #22D3EE, #3B82F6)":"linear-gradient(135deg, #FF6B6B, #FF8E53)",o={backgroundImage:p,WebkitBackgroundClip:"text",backgroundClip:"text",WebkitTextFillColor:"transparent",color:"transparent"};return e.jsxs("div",{style:{minHeight:"100vh",backgroundColor:t.bg,color:t.text},className:"d-flex flex-column font-inter transition-colors",children:[e.jsx("nav",{className:"sticky-top shadow-sm",style:{zIndex:100,backgroundColor:t.navBg,borderBottom:`1px solid ${t.borderColor}`},children:e.jsx("div",{className:"container py-3",children:e.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[e.jsxs("div",{className:"d-flex align-items-center gap-3",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-center rounded-3 shadow-sm",style:{width:"40px",height:"40px",background:p},children:e.jsx(V,{className:"text-white",size:24})}),e.jsxs("div",{children:[e.jsx("h1",{className:"h5 mb-0 fw-bold",style:{color:t.text},children:"NovaChat"}),e.jsx("p",{className:"mb-0 small",style:{color:t.textMuted},children:"Business Intelligence Assistant"})]})]}),e.jsxs("div",{className:"d-flex align-items-center gap-3",children:[e.jsx("button",{onClick:n,className:"btn btn-link p-2",style:{color:t.textMuted},title:r?"Switch to Light Mode":"Switch to Dark Mode",children:r?e.jsx(ee,{size:20}):e.jsx(te,{size:20})}),e.jsx("button",{onClick:s,className:"btn btn-link text-decoration-none fw-semibold",style:{color:t.textMuted},children:"Login"}),e.jsx("button",{onClick:a,className:"btn text-white fw-semibold px-4 py-2 rounded-3 shadow-sm border-0 transition-all hover-transform",style:{background:p},children:"Get Started"})]})]})})}),e.jsx("section",{className:"py-5",style:{background:t.heroGradient},children:e.jsxs("div",{className:"container pt-4 pb-5",children:[e.jsxs("div",{className:"text-center mx-auto",style:{maxWidth:"800px"},children:[e.jsxs("div",{className:"d-inline-flex align-items-center gap-2 px-3 py-1 rounded-pill mb-4 shadow-sm",style:{backgroundColor:r?"rgba(34, 211, 238, 0.1)":"#FFF5F5",border:`1px solid ${r?"#22D3EE":"#FF6B6B"}`,color:r?"#22D3EE":"#FF6B6B"},children:[e.jsx(W,{size:16,className:"opacity-75"}),e.jsx("span",{className:"small fw-semibold",children:"Powered by Advanced RAG Technology"})]}),e.jsxs("h2",{className:"display-4 fw-bold mb-4 lh-tight",style:{color:t.text},children:["Your Business Data,",e.jsx("br",{}),e.jsx("span",{style:o,children:" Explained Intelligently"})]}),e.jsx("p",{className:"lead mb-5",style:{lineHeight:"1.8",color:t.textMuted},children:"Ask questions in natural language. Get instant insights from your databases, documents, and data warehouses. No SQL required. No waiting for reports. Just intelligent answers."})]}),e.jsx("div",{className:"mt-5 position-relative mx-auto",style:{maxWidth:"1000px"},children:e.jsxs("div",{className:"rounded-4 shadow-lg border overflow-hidden",style:{backgroundColor:t.cardBg,borderColor:t.borderColor},children:[e.jsxs("div",{className:"px-4 py-3 border-bottom d-flex align-items-center gap-2",style:{backgroundColor:r?"#1F2937":"#F9FAFB",borderColor:t.borderColor},children:[e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("div",{className:"rounded-circle bg-danger opacity-50",style:{width:12,height:12}}),e.jsx("div",{className:"rounded-circle bg-warning opacity-50",style:{width:12,height:12}}),e.jsx("div",{className:"rounded-circle bg-success opacity-50",style:{width:12,height:12}})]}),e.jsx("span",{className:"ms-3 small fw-medium",style:{color:t.textMuted},children:"Analytics Assistant"})]}),e.jsx("div",{className:"p-4 p-md-5",style:{backgroundColor:t.cardBg},children:e.jsxs("div",{className:"d-flex flex-column gap-4",children:[e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx("div",{className:"text-white rounded-4 rounded-top-right-0 px-4 py-3 shadow-sm",style:{background:p,maxWidth:"400px",borderTopRightRadius:"4px"},children:"Why did sales drop in the South region?"})}),e.jsxs("div",{className:"d-flex gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center",style:{width:36,height:36,background:p},children:e.jsx(ue,{size:20,className:"text-white"})})}),e.jsxs("div",{className:"rounded-4 rounded-top-left-0 p-4 border shadow-sm",style:{borderTopLeftRadius:"4px",maxWidth:"650px",backgroundColor:r?"#1F2937":"#F9FAFB",borderColor:t.borderColor},children:[e.jsxs("p",{className:"mb-3",style:{color:t.text},children:["Sales in the South region decreased by ",e.jsx("strong",{style:{color:r?"#22D3EE":"#FF6B6B"},children:"12% in Q2"}),", mainly due to higher discounts in the Furniture category."]}),e.jsx("p",{className:"small mb-2 fw-semibold",style:{color:t.textMuted},children:"Key Insights:"}),e.jsxs("ul",{className:"small mb-0 ps-3",style:{color:t.textMuted},children:[e.jsx("li",{className:"mb-1",children:"Total sales dropped from $850K to $748K"}),e.jsx("li",{className:"mb-1",children:"Furniture category saw a 23% decline"}),e.jsx("li",{children:"Discount rates increased from 8% to 15%"})]})]})]}),e.jsxs("div",{className:"d-flex gap-2 ps-5 ms-2",children:[e.jsxs("span",{className:"badge border px-3 py-2 rounded-pill fw-normal d-flex align-items-center gap-2",style:{backgroundColor:t.cardBg,color:t.textMuted,borderColor:t.borderColor},children:[e.jsx(me,{size:14})," View monthly trend"]}),e.jsxs("span",{className:"badge border px-3 py-2 rounded-pill fw-normal d-flex align-items-center gap-2",style:{backgroundColor:t.cardBg,color:t.textMuted,borderColor:t.borderColor},children:[e.jsx(V,{size:14})," Category breakdown"]})]})]})})]})})]})}),e.jsx("section",{className:"py-5",style:{backgroundColor:t.cardBg},children:e.jsxs("div",{className:"container py-4",children:[e.jsxs("div",{className:"text-center mb-5",children:[e.jsx("h3",{className:"h2 fw-bold mb-3",style:{color:t.text},children:"See It In Action"}),e.jsx("p",{className:"lead",style:{color:t.textMuted},children:"Real questions, instant insights"})]}),e.jsx("div",{className:"row g-4",children:l.map((f,y)=>e.jsx("div",{className:"col-md-4",children:e.jsxs("div",{className:"h-100 p-4 rounded-4 border hover-shadow transition-all",style:{transition:"box-shadow 0.3s",backgroundColor:t.cardBg,borderColor:t.borderColor},children:[e.jsx("div",{className:"fw-semibold mb-3 fs-5",style:{color:r?"#22D3EE":"#FF6B6B"},children:f.question}),e.jsx("p",{className:"mb-0",style:{color:t.textMuted},children:f.insight})]})},y))})]})}),e.jsx("section",{className:"py-5",style:{backgroundColor:t.bg},children:e.jsxs("div",{className:"container py-4",children:[e.jsxs("div",{className:"text-center mb-5",children:[e.jsx("h3",{className:"h2 fw-bold mb-3",style:{color:t.text},children:"Everything You Need"}),e.jsx("p",{className:"lead",style:{color:t.textMuted},children:"Powerful features designed for modern business analytics"})]}),e.jsx("div",{className:"row g-4",children:d.map((f,y)=>{const j=f.icon;return e.jsx("div",{className:"col-md-4 col-lg-4",children:e.jsx("div",{className:"card h-100 border-0 shadow-sm rounded-4 hover-translate-y transition-all",style:{backgroundColor:t.cardBg},children:e.jsxs("div",{className:"card-body p-4",children:[e.jsx("div",{className:"mb-4 d-inline-flex p-3 rounded-3 bg-opacity-10",style:{backgroundColor:t.featureIconBg},children:e.jsx(j,{size:24,style:{color:r?"#22D3EE":"#FF6B6B"}})}),e.jsx("h4",{className:"h5 fw-bold mb-3",style:{color:t.text},children:f.title}),e.jsx("p",{className:"card-text",style:{color:t.textMuted},children:f.description})]})})},y)})})]})}),e.jsx("footer",{className:"py-4 border-top",style:{backgroundColor:t.cardBg,borderColor:t.borderColor},children:e.jsx("div",{className:"container text-center",children:e.jsxs("div",{className:"d-flex flex-column flex-md-row justify-content-between align-items-center gap-3",children:[e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-center rounded-2",style:{width:"24px",height:"24px",background:p},children:e.jsx(V,{className:"text-white",size:14})}),e.jsx("small",{style:{color:t.textMuted},children:"© 2026 NovaChat. All rights reserved."})]}),e.jsxs("div",{className:"d-flex gap-4",children:[e.jsx("a",{href:"#",className:"text-decoration-none small",style:{color:t.textMuted},children:"Privacy Policy"}),e.jsx("a",{href:"#",className:"text-decoration-none small",style:{color:t.textMuted},children:"Terms of Service"}),e.jsx("a",{href:"#",className:"text-decoration-none small",style:{color:t.textMuted},children:"Contact"})]})]})})})]})}function Dt(){const{user:s,isAuthenticated:a,logout:h}=oe(),{activeConversationId:n,messages:r,createNewConversation:t,startNewChat:d,updateSidebarItem:l}=Ae(),[c,F]=i.useState(""),[p,o]=i.useState([]),[f,y]=i.useState(!1),j=i.useRef(null),[N,k]=i.useState(!1),[b,M]=i.useState(!1),[S,u]=i.useState(window.innerWidth>768);i.useEffect(()=>{const g=()=>{window.innerWidth<=768?u(!1):u(!0)};return window.addEventListener("resize",g),()=>window.removeEventListener("resize",g)},[]);const[x,D]=i.useState(()=>localStorage.getItem("theme")||"dark"),_=g=>{const v=document.documentElement;let E=g;g==="system"&&(E=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),E==="dark"?(v.classList.add("dark-theme"),v.classList.remove("light-theme")):(v.classList.add("light-theme"),v.classList.remove("dark-theme"))},R=g=>{D(g),localStorage.setItem("theme",g),_(g)};i.useEffect(()=>{_(x);const g=window.matchMedia("(prefers-color-scheme: dark)"),v=()=>{x==="system"&&_("system")};return g.addEventListener("change",v),()=>g.removeEventListener("change",v)},[x]);const O=()=>{R(x==="light"||x==="system"?"dark":"light")};i.useEffect(()=>{if(a&&r.length>0){const g=r.map(v=>{const E=v.artifacts?.find(P=>P.type==="chart");let A=null;return E&&(A={type:E.chart_type,data:E.data_snapshot||E.spec}),{role:v.role,content:v.content,chart:A}});o(g)}},[r,a]),i.useEffect(()=>{!n&&a&&o([])},[n,a]),i.useEffect(()=>{a||o([])},[a]);const w=()=>{o([]),a&&d()},m=g=>{F(g)},C=async g=>{if(f){j.current&&(j.current.abort(),j.current=null),y(!1);return}const v=c;if(!v.trim())return;const E={role:"user",content:v};o(P=>[...P,E]),F(""),y(!0),j.current=new AbortController;let A=n;try{if(a&&!A)try{A=(await t(v)).id,await Z({conversation_id:A,content:v,role:"user"})}catch(T){console.error("Failed to create conversation:",T)}else if(a&&A)try{await Z({conversation_id:A,content:v,role:"user"})}catch(T){console.error("Failed to save message:",T)}const P=await fetch(`${se}/query`,{method:"POST",headers:{"Content-Type":"application/json",...ae()},body:JSON.stringify({query:E.content,history:p,session_id:A||""}),signal:j.current.signal});if(!P.ok)throw new Error("Network response was not ok");const Y=P.body.getReader(),Be=new TextDecoder;let z={role:"assistant",content:"",chart:null};for(o(T=>[...T,z]);;){const{done:T,value:J}=await Y.read();if(T)break;const Me=Be.decode(J).split(`
`).filter(Q=>Q.trim()!=="");for(const Q of Me)try{const $=JSON.parse(Q);$.type==="token"?(z.content+=$.chunk,o(H=>{const L=[...H];return L[L.length-1]={...z},L})):$.type==="chart"?(z.chart=$.content,o(H=>{const L=[...H];return L[L.length-1]={...z},L})):$.type==="error"&&(z.content+=`
[Error: ${$.content}]`,o(H=>{const L=[...H];return L[L.length-1]={...z},L}))}catch($){console.error("Error parsing chunk",$)}}if(a&&A&&z.content)try{const T=await Z({conversation_id:A,content:z.content,role:"assistant"});if(l(A,v.substring(0,100)),z.chart)try{await Mt({message_id:T.message_id,conversation_id:A,type:"chart",chart_type:z.chart.type,data_snapshot:z.chart.data})}catch(J){console.error("Failed to save artifact:",J)}}catch(T){console.error("Failed to save assistant message:",T)}}catch(P){P.name==="AbortError"?console.log("Fetch aborted"):(console.error("Error:",P),o(Y=>[...Y,{role:"assistant",content:"Sorry, I encountered an error connecting to the server."}]))}finally{y(!1)}};return a?e.jsxs("div",{className:"d-flex vh-100 overflow-hidden text-gray-900 bg-white",children:[a&&e.jsxs(e.Fragment,{children:[S&&window.innerWidth<=768&&e.jsx("div",{className:"mobile-backdrop",onClick:()=>u(!1)}),S&&e.jsx(Tt,{isOpen:S,onClose:()=>u(!1),theme:x==="system"?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":x})]}),e.jsxs("div",{className:"flex-grow-1 d-flex flex-column relative px-0 bg-white",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between p-2 px-3 border-bottom bg-white",children:[e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[a&&e.jsx("button",{onClick:()=>u(!S),className:"btn btn-link p-1 text-muted",title:S?"Hide sidebar":"Show sidebar",children:S?e.jsx(et,{size:20}):e.jsx(tt,{size:20})}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("div",{className:"p-2 rounded-circle d-flex align-items-center justify-content-center",style:{width:"36px",height:"36px",background:"linear-gradient(135deg, #22D3EE, #3B82F6)",boxShadow:"0 0 10px rgba(34, 211, 238, 0.4)"},children:e.jsx(W,{size:18,className:"text-white"})}),e.jsx("span",{className:"fw-semibold",style:{color:"#374151"},children:"NovaChat"})]})]}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("button",{onClick:O,className:"btn btn-link p-1 text-muted",title:x==="dark"?"Switch to Light Mode":"Switch to Dark Mode",children:x==="dark"?e.jsx(ee,{size:18}):e.jsx(te,{size:18})}),a?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"small text-muted d-none d-md-inline",children:s?.email}),e.jsx("button",{onClick:()=>k(!0),className:"btn btn-link p-1 text-muted",title:"Settings",children:e.jsx(st,{size:18})}),e.jsx("button",{onClick:h,className:"btn btn-link p-1 text-muted",title:"Logout",children:e.jsx(rt,{size:18})})]}):e.jsxs("button",{onClick:()=>M(!0),className:"btn btn-sm px-3 py-1",style:{background:x==="light"?"linear-gradient(135deg, #FF6B6B, #FF8E53)":"linear-gradient(135deg, #22D3EE, #3B82F6)",border:"none",color:"white",borderRadius:"8px",fontWeight:"500"},children:[e.jsx(we,{size:14,className:"me-1"}),"Sign In"]})]})]}),e.jsxs(Pe,{fluid:!0,className:"flex-grow-1 d-flex flex-column p-0 overflow-hidden position-relative",children:[e.jsx(wt,{history:p,isLoading:f,onQuickAction:m,theme:x==="system"?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":x}),e.jsx(ht,{query:c,setQuery:F,onSend:()=>C(),isLoading:f,onNewChat:w})]})]}),e.jsx(dt,{show:N,onClose:()=>k(!1),onClearHistory:w,currentTheme:x,onThemeChange:R}),e.jsx(pe,{show:b,onClose:()=>M(!1),theme:x==="system"?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":x})]}):e.jsxs(e.Fragment,{children:[e.jsx(Lt,{onLogin:()=>M(!0),onSignup:()=>M(!0),currentTheme:x==="system"?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":x,onToggleTheme:O}),e.jsx(pe,{show:b,onClose:()=>M(!1),theme:x==="system"?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":x})]})}function Pt(){return e.jsx(Ft,{children:e.jsx(zt,{children:e.jsx(Dt,{})})})}ct.createRoot(document.getElementById("root")).render(e.jsx(fe.StrictMode,{children:e.jsx(Pt,{})}));
